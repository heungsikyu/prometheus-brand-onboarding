groups:
- name: brand_onboarding_alerts
  rules:
  
  # === ğŸ¢ ë¸Œëœë“œ ì˜¨ë³´ë”© ì•Œë¦¼ ===
  
  # ë¸Œëœë“œ ë“±ë¡ ì‹¤íŒ¨ìœ¨ ë†’ìŒ
  - alert: HighBrandRegistrationFailureRate
    expr: |
      (
        rate(brand_registrations_total{status=~"failed.*"}[5m]) /
        rate(brand_registrations_total[5m])
      ) > 0.1
    for: 2m
    labels:
      severity: warning
      service: brand_onboarding
    annotations:
      summary: "ë¸Œëœë“œ ë“±ë¡ ì‹¤íŒ¨ìœ¨ì´ 10%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤"
      description: "ì§€ë‚œ 5ë¶„ê°„ ë¸Œëœë“œ ë“±ë¡ ì‹¤íŒ¨ìœ¨ì´ {{ $value | humanizePercentage }}ì…ë‹ˆë‹¤"
      
  # ì˜¨ë³´ë”© ì‹œê°„ ì§€ì—°
  - alert: SlowBrandOnboarding
    expr: |
      histogram_quantile(0.95, 
        rate(brand_onboarding_duration_seconds_bucket[5m])
      ) > 30
    for: 1m
    labels:
      severity: warning
      service: brand_onboarding
    annotations:
      summary: "ë¸Œëœë“œ ì˜¨ë³´ë”© ì‹œê°„ì´ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤"
      description: "95% ì˜¨ë³´ë”© ì‹œê°„ì´ {{ $value }}ì´ˆì…ë‹ˆë‹¤ (ê¸°ì¤€: 30ì´ˆ)"
  
  # === ğŸš€ API ì„±ëŠ¥ ì•Œë¦¼ ===
  
  # API ì‘ë‹µ ì‹œê°„ ì§€ì—°
  - alert: SlowAPIResponse
    expr: |
      histogram_quantile(0.95,
        rate(http_request_duration_seconds_bucket[5m])
      ) > 2.0
    for: 1m
    labels:
      severity: critical
      service: api
    annotations:
      summary: "API ì‘ë‹µ ì‹œê°„ì´ ì„ê³„ê°’ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤"
      description: "95% API ì‘ë‹µ ì‹œê°„ì´ {{ $value }}ì´ˆì…ë‹ˆë‹¤"
      
  # API ì—ëŸ¬ìœ¨ ë†’ìŒ
  - alert: HighAPIErrorRate
    expr: |
      (
        rate(http_requests_total{status=~"5.."}[5m]) /
        rate(http_requests_total[5m])
      ) > 0.05
    for: 2m
    labels:
      severity: critical
      service: api
    annotations:
      summary: "API ì—ëŸ¬ìœ¨ì´ 5%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤"
      description: "ì§€ë‚œ 5ë¶„ê°„ ì—ëŸ¬ìœ¨: {{ $value | humanizePercentage }}"
  
  # === ğŸ’¾ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì•Œë¦¼ ===
  
  # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ë†’ìŒ
  - alert: HighMemoryUsage
    expr: |
      (
        memory_usage_bytes{type="used"} /
        memory_usage_bytes{type="total"}
      ) > 0.9
    for: 5m
    labels:
      severity: warning
      service: system
    annotations:
      summary: "ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 90%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤"
      description: "í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : {{ $value | humanizePercentage }}"
      
  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
  - alert: DatabaseConnectionFailure
    expr: |
      rate(database_operations_total{status="error"}[5m]) > 0
    for: 1m
    labels:
      severity: critical
      service: database
    annotations:
      summary: "ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"
      description: "DB ì˜¤ë¥˜ìœ¨: {{ $value }}/ì´ˆ"
